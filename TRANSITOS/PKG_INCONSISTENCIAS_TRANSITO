--HEAD

create or replace PACKAGE PKG_INCONSISTENCIAS_TRANSITOS AS 

/*ISVA
Nombre     :PKG_INCONSISTENCIAS_TRANSITOS
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :VN_RADICADO
Retorno    :           
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Realizar las validaciones generar procesos 
correspondiente
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

Procedure Sp_Iniciar_Inconsistencia (as_id_radicado Simple_Integer);

END PKG_INCONSISTENCIAS_TRANSITOS;


--BODY

create or replace PACKAGE BODY PKG_INCONSISTENCIAS_TRANSITOS AS

iv_Transito Varchar2(255 Byte);
GS_RADICADO Simple_Integer:=0;

Procedure Sp_Registrar_Transito As

/*ISVA
Nombre     :Sp_Registrar_Transito
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :iv_Transito
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Recupera el nombre del transito
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

Begin
iv_Transito:='';

    Select Distinct Fm.Municipio Into iv_Transito From St_Maestro Sm
    Inner Join Bd_Fiscalizacion.Fc_Municipio_Departamento Fm On Fm.Divipo = Sm.Id_Secretaria
    Where Id_Radicado = GS_RADICADO;

Exception 
    When Others Then 
    iv_Transito:='';    
    
End Sp_Registrar_Transito;

Procedure SP_Inconsistencia_Vehiculos As

/*ISVA
Nombre     :SP_Inconsistencia_Vehiculos
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :lv_Archivo, lb_Existe, lutl_archivo, lcur_vehiculos
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Genera las inconsistencias por transito 
           :para los vehiculos
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):=GS_RADICADO||' '||iv_Transito||' VEHICULOS ' ||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;

lutl_archivo UTL_FILE.FILE_TYPE;
        
        Cursor lcur_vehiculos Is 
            -- VALIDO LONGITUD DE NRO_PLACA
        SELECT  iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NRO_PLACA) > 6 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_MARCA
        SELECT   iv_Transito ,'Longitud ID_MARCA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.ID_MARCA,'.','')) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_MARCA
        SELECT   iv_Transito ,'Longitud NOMBRE_MARCA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_MARCA) > 40 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_LINEA
        SELECT   iv_Transito ,'Longitud ID_LINEA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.ID_LINEA,'.','')) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_LINEA
        SELECT   iv_Transito ,'Longitud NOMBRE_LINEA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_LINEA) > 40 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE MODELO
        SELECT   iv_Transito ,'Longitud MODELO mayor a la permitida(4)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.MODELO,'.','')) > 4 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CLASE
        SELECT   iv_Transito ,'Longitud ID_CLASE mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_CLASE) > 8 and ST_V.id_radicado =GS_RADICADO
        
        
        
        union 
        
        -- VALIDO LONGITUD DE ID_LINEA
        SELECT   iv_Transito ,'Longitud ID_LINEA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_LINEA) > 8 and ST_V.id_radicado =GS_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CLASE
        SELECT   iv_Transito ,'Longitud NOMBRE_CLASE mayor a la permitida(40)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_CLASE) > 40 and ST_V.id_radicado =GS_RADICADO
        
        
        
        union 
        
        -- VALIDO LONGITUD DE ID_SERVICIO
        SELECT   iv_Transito ,'Longitud ID_SERVICIO mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_SERVICIO) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union 
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO
        SELECT   iv_Transito ,'Longitud NOMBRE_SERVICIO mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_SERVICIO) > 40 and ST_V.id_radicado =GS_RADICADO
        
        union 
        
        -- VALIDO LONGITUD DE ID_CARROCERIA
        SELECT   iv_Transito ,'Longitud ID_CARROCERIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_CARROCERIA) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA
        SELECT   iv_Transito ,'Longitud NOMBRE_CARROCERIA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_CARROCERIA) > 40 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_COMBUSTIBLE
        SELECT   iv_Transito ,'Longitud ID_COMBUSTIBLE mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_COMBUSTIBLE) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_BATERIA
        SELECT   iv_Transito ,'Longitud ID_BATERIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_BATERIA) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_BATERIA
        SELECT   iv_Transito ,'Longitud NOMBRE_BATERIA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_BATERIA) > 10 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE POTENCIA
        SELECT   iv_Transito ,'Longitud POTENCIA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.POTENCIA) > 10 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA
        SELECT   iv_Transito ,'Longitud ID_SECRETARIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_SECRETARIA) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SECRETARIA
        SELECT   iv_Transito ,'Longitud NOMBRE_SECRETARIA mayor a la permitida(80)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_SECRETARIA) > 80 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CILINDRAJE
        SELECT   iv_Transito ,'Longitud CILINDRAJE mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CILINDRAJE) > 10 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_PASAJEROS
        SELECT   iv_Transito ,'Longitud CAP_PASAJEROS mayor a la permitida(3)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CAP_PASAJEROS) > 3 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_TONELADAS
        SELECT   iv_Transito ,'Longitud CAP_TONELADAS mayor a la permitida(6)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CAP_TONELADAS) > 6 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE VALOR_FACTURA
        SELECT   iv_Transito ,'Longitud VALOR_FACTURA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.VALOR_FACTURA) > 10 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE BLINDADO
        SELECT   iv_Transito ,'Longitud BLINDADO mayor a la permitida(1)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.BLINDADO) > 1 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE IMPORTADO_NACIONAL
        SELECT   iv_Transito ,'Longitud IMPORTADO_NACIONAL mayor a la permitida(2)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.IMPORTADO_NACIONAL) > 2 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_ESTADO
        SELECT   iv_Transito ,'Longitud ID_ESTADO mayor a la permitida(4)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_ESTADO) > 4 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_ESTADO
        SELECT   iv_Transito ,'Longitud NOMBRE_ESTADO mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_ESTADO) > 40 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CLASICO_ANTIGUO
        SELECT   iv_Transito ,'Longitud CLASICO_ANTIGUO mayor a la permitida(1)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CLASICO_ANTIGUO) > 1 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NRO_PUERTAS
        SELECT   iv_Transito ,'Longitud NRO_PUERTAS mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NRO_PUERTAS) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MATRICULO
        SELECT   iv_Transito ,'Longitud FECHA_MATRICULO mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.FECHA_MATRICULO) > 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MATRICULO
        SELECT   iv_Transito ,'Longitud FECHA_MATRICULO menos a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,ST_V.*
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.FECHA_MATRICULO) < 8 and ST_V.id_radicado =GS_RADICADO
        
        union
        
        Select iv_Transito Secretaria, 
               'Vehiculos No Reportados En Tramites' Inconsistencia, 'Vehiculos' ARCHIVO, sv.* 
        from TMP_VEHICULOS sv
        left join TMP_TRAMITES st on st.nro_placa = sv.nro_placa and sv.id_radicado = st.Id_radicado
        where st.nro_placa is null and sv.id_radicado =GS_RADICADO
        
        union
        
        Select  iv_Transito Secretaria, 
               'Vehiculos No Reportados En Propietarios' Inconsistencia, 'Vehiculos' ARCHIVO, sv.*
        from TMP_VEHICULOS sv
        left join TMP_propietarios sp on sp.nro_placa = sv.nro_placa and sv.id_radicado = sp.Id_radicado
        where sp.nro_placa is null and sv.id_radicado =GS_RADICADO
        
        union
        
        --Carrocerias x clase Vehiculos
        select  iv_Transito Secretaria, 
               'Carroceria Sin Relacion a La Clase (Vehiculos)' Inconsistencia,'VEHICULOS' ARCHIVO, sv.* 
        from TMP_VEHICULOS sv
        left join CORRECCION_DATOS.RUNT_CARROCERIAS_X_CLASE rc
                on rc.codigo_clase = REPLACE (sv.id_clase,'.','') and rc.codigo_carroceria_ws = REPLACE (SV.ID_CARROCERIA,'.','')
        where RC.CODIGO_CARROCERIA_WS is null And Sv.Id_Carroceria is Not null and sv.id_radicado =GS_RADICADO 
        
        
        union
        
        --Lineas sin relacion a la marca transformacion
        select  iv_Transito As Secretaria, 
               'Linea Sin Relacion a La Marca' Inconsistencia,'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        left join CORRECCION_DATOS.runt_linea rl
                on rl.codigo_marca = REPLACE (sv.id_marca,'.','') and rl.codigo_linea_ws = REPLACE (sv.ID_LINEA,'.','')
        where  rl.codigo_linea_ws is null And Id_Linea is not null and sv.id_radicado =GS_RADICADO 
        
        union
        
        --Id_Marca con punto
        select  iv_Transito Secretaria, 
               'Id_Marca con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where sv.id_marca like '%.%' and sv.id_radicado =GS_RADICADO
        
        union
        
        --Id_Linea con punto
        select  iv_Transito Secretaria, 
               'Id_Linea con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where sv.id_linea like '%.%' and sv.id_radicado =GS_RADICADO
        
        union
        
        --Id_Linea con punto
        select iv_Transito Secretaria, 
               'Modelo con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where sv.modelo like '%.%' and sv.id_radicado =GS_RADICADO
        
        union
        
        --VALIDACION DE CAMPOS NULL
        
        select  iv_Transito Secretaria, 
               'Id_Marca Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Id_Marca is null  and sv.id_radicado =GS_RADICADO 
        
        union
        
        select  iv_Transito Secretaria, 
               'Nro_placa Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  Sv.nro_placa is null and sv.id_radicado =GS_RADICADO 
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Linea Null' Inconsistencia,'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.id_linea is null  and sv.id_radicado =GS_RADICADO 
        
        union 
        
        select  iv_Transito Secretaria, 
               'Modelo Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Modelo is null  and sv.id_radicado =GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Clase Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.ID_CLASE is null  and sv.id_radicado =GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Servicio Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Id_Servicio is null and sv.id_radicado =GS_RADICADO 
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Carroceria Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Id_Carroceria is null and sv.id_radicado =GS_RADICADO 
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Combustible Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Id_Combustible is null  and sv.id_radicado =GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Secretaria Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Id_Secretaria is null  and sv.id_radicado =GS_RADICADO
        
        union 
        select  iv_Transito Secretaria,
        'Cilindraje Null o Cero' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  (SV.Cilindraje  is null or SV.Cilindraje = 0) And Id_Combustible Not In (5)
        And sv.id_radicado =GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Valor_Factura Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Valor_Factura is null  and sv.id_radicado =GS_RADICADO
        
        union 
        
        select   iv_Transito Secretaria, 
               'Fecha_Matriculo Null' Inconsistencia, 'VEHICULOS' ARCHIVO,sv.*
        from TMP_VEHICULOS sv
        where  SV.Fecha_Matriculo is null  and sv.id_radicado =GS_RADICADO;

Begin 
    lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
        For Ln_Index In lcur_vehiculos Loop
        Begin
             
            If lb_Existe = False Then
                UTL_FILE.PUT_LINE(lutl_archivo,'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'NRO_PLACA;'||'ID_MARCA;'||'NOMBRE_MARCA;'
                                                ||'ID_LINEA;'||'NOMBRE_LINEA;'||'MODELO;'||'ID_CLASE;'||'NOMBRE_CLASE;'||'ID_SERVICIO;'
                                                ||'NOMBRE_SERVICIO;'||'ID_CARROCERIA;'||'NOMBRE_CARROCERIA;'||'NRO_PUERTAS;'
                                                ||'ID_COMBUSTIBLE;'||'NOMBRE_COMBUSTIBLE;'||'ID_BATERIA;'||'NOMBRE_BATERIA;'
                                                ||'POTENCIA;'||'ID_SECRETARIA;'||'NOMBRE_SECRETARIA;'||'CILINDRAJE;'||'CAP_PASAJEROS;'
                                                ||'CAP_TONELADAS;'||'VALOR_FACTURA;'||'BLINDADO;'||'IMPORTADO_NACIONAL;'||'ID_ESTADO;'
                                                ||'NOMBRE_ESTADO;'||'CLASICO_ANTIGUO;'||'FECHA_MATRICULO;'||'ID_RADICADO;'||'ID_MARCA2;'
                                                ||'ID_LINEA2;'||'CAJA;'||'TRACCION;'||'COMBUSTION');
                     lb_Existe:=True;
            End If;
            UTL_FILE.PUT_LINE(lutl_archivo,iv_Transito||';'
            ||Ln_Index.INCONSISTENCIA||';'
            ||Ln_Index.ARCHIVO||';'
            ||Ln_Index.NRO_PLACA||';'
            ||Ln_Index.ID_MARCA||';'
            ||Ln_Index.NOMBRE_MARCA||';'
            ||Ln_Index.ID_LINEA||';'
            ||Ln_Index.NOMBRE_LINEA||';'
            ||Ln_Index.MODELO||';'
            ||Ln_Index.ID_CLASE||';'
            ||Ln_Index.NOMBRE_CLASE||';'
            ||Ln_Index.ID_SERVICIO||';'
            ||Ln_Index.NOMBRE_SERVICIO||';'
            ||Ln_Index.ID_CARROCERIA||';'
            ||Ln_Index.NOMBRE_CARROCERIA||';'
            ||Ln_Index.NRO_PUERTAS||';'
            ||Ln_Index.ID_COMBUSTIBLE||';'
            ||Ln_Index.NOMBRE_COMBUSTIBLE||';'
            ||Ln_Index.ID_BATERIA||';'
            ||Ln_Index.NOMBRE_BATERIA||';'
            ||Ln_Index.POTENCIA||';'
            ||Ln_Index.ID_SECRETARIA||';'
            ||Ln_Index.NOMBRE_SECRETARIA||';'
            ||Ln_Index.CILINDRAJE||';'
            ||Ln_Index.CAP_PASAJEROS||';'
            ||Ln_Index.CAP_TONELADAS||';'
            ||Ln_Index.VALOR_FACTURA||';'
            ||Ln_Index.BLINDADO||';'
            ||Ln_Index.IMPORTADO_NACIONAL||';'
            ||Ln_Index.ID_ESTADO||';'
            ||Ln_Index.NOMBRE_ESTADO||';'
            ||Ln_Index.CLASICO_ANTIGUO||';'
            ||Ln_Index.FECHA_MATRICULO||';'
            ||Ln_Index.ID_RADICADO||';'
            ||Ln_Index.ID_MARCA2||';'
            ||Ln_Index.ID_LINEA2||';'
            ||Ln_Index.CAJA||';'
            ||Ln_Index.TRACCION||';'
            ||Ln_Index.COMBUSTION);
            
            Exception 
                When Others Then 
                    Dbms_Output.Put_Line(sqlerrm||Dbms_Utility.Format_Error_Backtrace||' '||'Sp_Vehiculos'); 
        End;   
        End Loop;
         UTL_FILE.FCLOSE(lutl_archivo); 
         
END Sp_Inconsistencia_Vehiculos;

Procedure Sp_Inconsistencia_Tramites As

/*ISVA
Nombre     :Sp_Inconsistencia_Tramites
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :lv_Archivo, lb_Existe, lutl_archivo, lcur_vehiculos
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Genera las inconsistencias por transito 
           :para los tramites
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):=GS_RADICADO||' '||iv_Transito||' TRAMITES '||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;

lutl_archivo UTL_FILE.FILE_TYPE;

-- VALIDO LONGITUD DE NRO_PLACA
        Cursor lcur_tramites Is 
        SELECT   iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NRO_PLACA) > 6 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_TRAMITE
        SELECT   iv_Transito ,'Longitud ID_TRAMITE mayor a la permitida(4)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_TRAMITE) > 4 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_TRAMITE
        SELECT   iv_Transito ,'Longitud NOMBRE_TRAMITE mayor a la permitida(40)' as INCONSISTENCIA, 'TRAMITES' as ARCHIVO,ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_TRAMITE) > 40 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_TRAMITE
        SELECT   iv_Transito ,'Longitud FECHA_TRAMITE mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.FECHA_TRAMITE) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        -- VALIDO LONGITUD DE FECHA_TRAMITE
        SELECT   iv_Transito ,'Longitud FECHA_TRAMITE menor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.FECHA_TRAMITE) < 8 and ST_T.id_radicado = GS_RADICADO
        
        /*union
        
        -- VALIDO LONGITUD DE TIPO_CANCELACION
        SELECT   iv_Transito,'Longitud TIPO_CANCELACION mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.TIPO_CANCELACION) > 8 and ST_T.id_radicado = GS_RADICADO*/
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA_DESTINO
        SELECT   iv_Transito ,'Longitud ID_SECRETARIA_DESTINO mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SECRETARIA_DESTINO) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA_ORIGEN
        SELECT  iv_Transito ,'Longitud ID_SECRETARIA_ORIGEN mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SECRETARIA_ORIGEN) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CARROCERIA_ANTERIOR
        SELECT   iv_Transito ,'Longitud ID_CARROCERIA_ANTERIOR mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_CARROCERIA_ANTERIOR) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA_ANTERIOR
        SELECT   iv_Transito ,'Longitud NOMBRE_CARROCERIA_ANTERIOR mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_CARROCERIA_ANTERIOR) > 40 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CARROCERIA_NUEVA
        SELECT   iv_Transito ,'Longitud ID_CARROCERIA_NUEVA mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_CARROCERIA_NUEVA) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA_NUEVA
        SELECT   iv_Transito ,'Longitud NOMBRE_CARROCERIA_NUEVA mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_CARROCERIA_NUEVA) > 40 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SERVICIO_ANTERIOR
        SELECT   iv_Transito ,'Longitud ID_SERVICIO_ANTERIOR mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SERVICIO_ANTERIOR) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO_ANTERIOR
        SELECT   iv_Transito ,'Longitud NOMBRE_SERVICIO_ANTERIOR mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_SERVICIO_ANTERIOR) > 40 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SERVICIO_NUEVO
        SELECT   iv_Transito ,'Longitud ID_SERVICIO_NUEVO mayor a la permitida(8)' as INCONSISTENCIA, 'TRAMITES' as ARCHIVO,ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SERVICIO_NUEVO) > 8 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO_NUEVO
        SELECT   iv_Transito ,'Longitud NOMBRE_SERVICIO_NUEVO mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_SERVICIO_NUEVO) > 40 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO_ANTERIOR
        SELECT   iv_Transito ,'Longitud ID_USUARIO_ANTERIOR mayor a la permitida(15)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_USUARIO_ANTERIOR) > 15 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO_NUEVO
        SELECT   iv_Transito ,'Longitud ID_USUARIO_NUEVO mayor a la permitida(15)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_USUARIO_NUEVO) > 15 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT   iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.PORCENTAJE_PROP) > 3 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CLASICO_ANTIGUO
        SELECT   iv_Transito ,'Longitud CLASICO_ANTIGUO mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CLASICO_ANTIGUO) > 1 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE BLINDADO
        SELECT   iv_Transito ,'Longitud BLINDADO mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.BLINDADO) > 1 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NIVEL_BLINDADO
        SELECT   iv_Transito ,'Longitud NIVEL_BLINDADO mayor a la permitida(2)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NIVEL_BLINDADO) > 2 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE DESBLINDAJE
        SELECT   iv_Transito ,'Longitud DESBLINDAJE mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.DESBLINDAJE) > 1 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CILINDRAJE
        SELECT   iv_Transito ,'Longitud CILINDRAJE mayor a la permitida(10)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CILINDRAJE) > 10 and ST_T.id_radicado = GS_RADICADO
                
        union
        
        -- VALIDO LONGITUD DE CAP_PASAJEROS
        SELECT   iv_Transito ,'Longitud CAP_PASAJEROS mayor a la permitida(3)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CAP_PASAJEROS) > 3 and ST_T.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_TONELADAS
        SELECT   iv_Transito ,'Longitud CAP_TONELADAS mayor a la permitida(6)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_T.*
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CAP_TONELADAS) > 6 and ST_T.id_radicado = GS_RADICADO
        
        UNION
        
        Select iv_Transito Secretaria, 
               'Tramites No Reportados En Propietarios' Inconsistencia, 'Tramites' ARCHIVO, sv.*
        from TMP_TRAMITES sv
        left join TMP_propietarios sp on sp.nro_placa = sv.nro_placa and sv.id_radicado = sp.Id_radicado
        where sp.nro_placa is null and sv.id_radicado = GS_RADICADO
        
        
        UNION
        
        Select iv_Transito Secretaria, 
               'Tramites No Reportados En Vehiculos' Inconsistencia, 'Tramites' ARCHIVO, st.*
        from TMP_TRAMITES st
        left join TMP_VEHICULOS sv on sv.nro_placa = st.nro_placa and sv.id_radicado = st.Id_radicado
        where sv.nro_placa is null and st.id_radicado = GS_RADICADO
        
        union
        --Validaciones tramites.
        
        --Radicaciones Sin Id_Origen.
        Select iv_Transito Secretaria, 
               'Radicaciones Sin Id_Origen' Inconsistencia, 'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 10 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Origen is null
        
        
        union
        
        --Radicaciones Sin Id_Destino.
        Select  iv_Transito Secretaria, 
               'Radicaciones Sin Id_Destino' Inconsistencia, 'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 10 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Destino Is Null
        
        
        union
        
        --Traslados Sin Id_Origen.
        Select iv_Transito Secretaria, 
               'Traslados Sin Id_Origen' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 15 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Origen Is Null
        
        
        union
        
        --Traslados Sin Id_Destino.
        Select  iv_Transito Secretaria, 
               'Traslados Sin Id_Destino' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 15 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Destino Is Null
        
        
        union
        
        --Blindajes Sin Nivel Blindado.
        Select  iv_Transito Secretaria, 
               'Blindajes Sin Nivel Blindado' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 1 and St.id_radicado = GS_RADICADO
          And St.Blindado Is Not Null And St.Nivel_Blindado is null
        
        
        union
        
        --Transformacion Carroceria Carga Con Capacidad Casajeros > 3.
        Select   iv_Transito Secretaria,  
               'Transformacion Carroceria Carga Con Capacidad Casajeros > 3' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 14 and St.id_radicado = GS_RADICADO
          And St.Id_Carroceria_Nueva in('7','8','9','10','12','13','15','17','18','20','21','31','32','42','43',
                                        '44','45','47','58','60','70','78','79','80','83','84','96','98','104',
                                        '115','116','119','125','133','136','142','150','172','174','187','189',
                                        '192','193','196','197','198','199')
          And to_number(St.Cap_Pasajeros) > 3        
        
        
        union
        
        --Id_carroceria nueva != carroceria OC
        Select  iv_Transito Secretaria, 
               'Id_Carroceria Nueva Diferente a Carroceria OC' Inconsistencia,'VEHICULOS' ARCHIVO, St.* 
        From TMP_VEHICULOS sv
        inner join TMP_TRAMITES St on st.nro_placa = sv.nro_placa
        Where St.Id_Tramite = 14  and St.id_radicado = GS_RADICADO
          And SV.ID_CARROCERIA is not null
          And SV.ID_CARROCERIA != ST.ID_CARROCERIA_NUEVA
          And sv.id_radicado = st.id_radicado
        
        
        union
        
        --Porcentaje Traspaso Mayor a 100.
        Select  iv_Transito Secretaria, 
               'Porcentaje Traspaso Mayor a 100' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite in (16,65) and St.id_radicado = GS_RADICADO
          And to_number(replace(St.Porcentaje_Prop,'.','')) > 100
        
        
        union
        
        
        --Id_Comprador igual a Id_Vendedor
        Select iv_Transito Secretaria, 
               'Id_Comprador Igual a Id_Vendedor' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite in (16,65) and St.id_radicado = GS_RADICADO
          And ST.ID_USUARIO_nuevo = ST.ID_USUARIO_anterior
        
        
        union
        
        --ID_SERVICIO_ANTERIOR = ID_SERVICIO_NUEVO
        Select iv_Transito Secretaria, 
               'Id_Servicio_Anterior Igual a Id_Servicio_Nuevo' Inconsistencia,'TRAMITES' ARCHIVO, St.* 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 6 and St.id_radicado = GS_RADICADO
          And ST.ID_SERVICIO_ANTERIOR = ST.ID_SERVICIO_NUEVO
        
        
        union
        
        --ID_SERVICIO_ANTERIOR = ID_SERVICIO_NUEVO
        Select  iv_Transito Secretaria, 
               'Id_Servicio_Nuevo Diferente a Id_Servicio_Oc' Inconsistencia,'VEHICULOS' ARCHIVO, St.* 
        From TMP_VEHICULOS sv
        inner join TMP_TRAMITES St on st.nro_placa = sv.nro_placa
        Where St.Id_Tramite = 6 and St.id_radicado = GS_RADICADO
          And sv.ID_SERVICIO != ST.ID_SERVICIO_NUEVO
          And sv.id_radicado = st.id_radicado
        
        union
        
        --Carrocerias x clase tramites transformacion
        select  iv_Transito Secretaria, 
               'Carroceria Sin Relacion a La Clase (Tramites)' Inconsistencia, 'VEHICULOS' ARCHIVO, st.* 
        from TMP_VEHICULOS sv
        inner join TMP_TRAMITES st on st.nro_placa = sv.nro_placa AND SV.ID_RADICADO = ST.ID_RADICADO
        left join CORRECCION_DATOS.RUNT_CARROCERIAS_X_CLASE rc
                on rc.codigo_clase = REPLACE (sv.id_clase,'.','')  and rc.codigo_carroceria_ws =REPLACE (st.ID_CARROCERIA_nueva,'.','') 
        where  st.id_tramite = 14 And RC.CODIGO_CARROCERIA_WS is null and sv.id_radicado = GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Tramite Null' Inconsistencia, 'TRAMITES' ARCHIVO, sv.*
        from TMP_TRAMITES sv
        where  SV.Id_Tramite is null  and sv.id_radicado = GS_RADICADO;
        
Begin
    lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
        For Ln_Index In lcur_tramites Loop
        Begin
         If lb_Existe = False Then
                    UTL_FILE.PUT_LINE(lutl_archivo,'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'NRO_PLACA;'||'ID_TRAMITE;'||'NOMBRE_TRAMITE;'
                                                ||'FECHA_TRAMITE;'||'TIPO_CANCELACION;'||'ID_SECRETARIA_DESTINO;'||'ID_SECRETARIA_ORIGEN;'
                                                ||'ID_CARROCERIA_ANTERIOR;'||'NOMBRE_CARROCERIA_ANTERIOR;'||'ID_CARROCERIA_NUEVA;'
                                                ||'NOMBRE_CARROCERIA_NUEVA;'||'ID_SERVICIO_ANTERIOR;'||'NOMBRE_SERVICIO_ANTERIOR;'
                                                ||'ID_SERVICIO_NUEVO;'||'NOMBRE_SERVICIO_NUEVO;'||'ID_DOCUMENTO_ANTERIOR;'||'ID_USUARIO_ANTERIOR;'
                                                ||'ID_DOCUMENTO_NUEVO;'||'ID_USUARIO_NUEVO;'||'PORCENTAJE_PROP;'||'CLASICO_ANTIGUO;'||'BLINDADO;'
                                                ||'NIVEL_BLINDADO;'||'DESBLINDAJE;'||'CILINDRAJE;'||'CAP_PASAJEROS;'||'CAP_TONELADAS;'||'ID_RADICADO');
                        lb_Existe:=True;
                 End If;
                UTL_FILE.PUT_LINE(lutl_archivo,iv_Transito||';'
                    ||Ln_Index.INCONSISTENCIA||';'
                    ||Ln_Index.ARCHIVO||';'
                    ||Ln_Index.NRO_PLACA||';'
                    ||Ln_Index.ID_TRAMITE||';'
                    ||Ln_Index.NOMBRE_TRAMITE||';'
                    ||Ln_Index.FECHA_TRAMITE||';'
                    ||Ln_Index.TIPO_CANCELACION||';'
                    ||Ln_Index.ID_SECRETARIA_DESTINO||';'
                    ||Ln_Index.ID_SECRETARIA_ORIGEN	||';'
                    ||Ln_Index.ID_CARROCERIA_ANTERIOR||';'
                    ||Ln_Index.NOMBRE_CARROCERIA_ANTERIOR||';'
                    ||Ln_Index.ID_CARROCERIA_NUEVA||';'
                    ||Ln_Index.NOMBRE_CARROCERIA_NUEVA||';'
                    ||Ln_Index.ID_SERVICIO_ANTERIOR||';'
                    ||Ln_Index.NOMBRE_SERVICIO_ANTERIOR||';'
                    ||Ln_Index.ID_SERVICIO_NUEVO||';'
                    ||Ln_Index.NOMBRE_SERVICIO_NUEVO||';'
                    ||Ln_Index.ID_DOCUMENTO_ANTERIOR||';'
                    ||Ln_Index.ID_USUARIO_ANTERIOR||';'
                    ||Ln_Index.ID_DOCUMENTO_NUEVO||';'
                    ||Ln_Index.ID_USUARIO_NUEVO||';'
                    ||Ln_Index.PORCENTAJE_PROP||';'
                    ||Ln_Index.CLASICO_ANTIGUO||';'
                    ||Ln_Index.BLINDADO||';'
                    ||Ln_Index.NIVEL_BLINDADO||';'
                    ||Ln_Index.DESBLINDAJE||';'
                    ||Ln_Index.CILINDRAJE||';'
                    ||Ln_Index.CAP_PASAJEROS||';'
                    ||Ln_Index.CAP_TONELADAS||';'
                    ||Ln_Index.ID_RADICADO);   
                    
                    Exception 
                        When Others Then 
                            Dbms_Output.Put_Line(sqlerrm||Dbms_Utility.Format_Error_Backtrace||' '||'Sp_Vehiculos'); 
            End;
            End Loop;
        UTL_FILE.FCLOSE(lutl_archivo);
End Sp_Inconsistencia_Tramites;

Procedure Sp_Inconsistencia_Propietarios As

/*ISVA
Nombre     :Sp_Inconsistencia_Propietarios
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :lv_Archivo, lb_Existe, lutl_archivo, lcur_vehiculos
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Genera las inconsistencias por transito 
           :para los propietarios
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):=GS_RADICADO||' '||iv_Transito||' PROPIETARIOS '||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;

lutl_archivo UTL_FILE.FILE_TYPE;

      -- VALIDO LONGITUD DE NRO_PLACA
        Cursor lcur_propietarios Is
        SELECT   iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, ST_P.*
        FROM TMP_propietarios ST_P
        where length (ST_P.NRO_PLACA) > 6 and ST_P.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO
        SELECT   iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, ST_P.*
        FROM TMP_propietarios ST_P
        where length (ST_P.ID_USUARIO) > 15 and ST_P.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DOCUMENTO
        SELECT   iv_Transito ,'Longitud ID_DOCUMENTO mayor a la permitida(1)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, ST_P.*
        FROM TMP_propietarios ST_P
        where length (ST_P.ID_DOCUMENTO) > 1 and ST_P.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT   iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, ST_P.*
        FROM TMP_propietarios ST_P
        where length (ST_P.PORCENTAJE_PROP) > 3 and ST_P.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT   iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA, 'PROPIETARIOS' as ARCHIVO,ST_P.*
        FROM TMP_propietarios ST_P
        where length (ST_P.PORCENTAJE_PROP) > 3 and ST_P.id_radicado = GS_RADICADO
        
        
        UNION
        
        Select  iv_Transito Secretaria, 
               'Propietarios No Reportados En Vehiculos' Inconsistencia, 'Propietarios' ARCHIVO, sp.*
        from TMP_propietarios sp
        left join TMP_VEHICULOS sv on sp.nro_placa = sv.nro_placa and sp.id_radicado = sv.Id_radicado
        where sv.nro_placa is null and sp.id_radicado = GS_RADICADO
        
        
        UNION
        
        Select   iv_Transito Secretaria, 
               'Propietarios No Reportados En Tramites' Inconsistencia, 'Propietarios' ARCHIVO, sp.*
        from TMP_propietarios sp
        left join TMP_TRAMITES st on sp.nro_placa = st.nro_placa and sp.id_radicado = st.Id_radicado
        where st.nro_placa is null and sp.id_radicado = GS_RADICADO
        
        
        UNION
        
        Select  iv_Transito Secretaria, 
               'Propietarios No Reportados En Contribuyentes' Inconsistencia, 'Propietarios' ARCHIVO, sp.*
        from TMP_propietarios sp
        left join TMP_CONTRIBUYENTES sc on Sp.Id_Usuario = Sc.Id_Usuario And Sp.Id_Documento = Sc.Id_Documento and sp.id_radicado = sc.Id_radicado
        where sc.Id_Usuario is null and sp.id_radicado = GS_RADICADO
        
        union
         
        
        select  iv_Transito Secretaria, 
               'Id_Usuario Null' Inconsistencia,'PROPIETARIOS' ARCHIVO, sv.*
        from TMP_propietarios sv
        where  SV.Id_Usuario is null  and sv.id_radicado = GS_RADICADO
        
        
        union 
        
        select   iv_Transito Secretaria, 
               'Id_Documento Null' Inconsistencia, 'PROPIETARIOS' ARCHIVO,sv.*
        from TMP_propietarios sv
        where  SV.Id_Documento is null  and sv.id_radicado = GS_RADICADO
        
        
        union 
        
        select  iv_Transito Secretaria, 
               'Porcentaje_Propiedad Null' Inconsistencia, 'PROPIETARIOS' ARCHIVO,sv.*
        from TMP_propietarios sv
        where  SV.Porcentaje_Prop is null  and sv.id_radicado = GS_RADICADO;
Begin
     lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
      For ln_index In lcur_propietarios Loop
             If lb_Existe = False Then
                UTL_FILE.PUT_LINE(lutl_archivo,'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'NRO_PLACA;'||'ID_USUARIO;'
                                               ||'ID_DOCUMENTO;'||'PORCENTAJE_PROP;'||'ID_RADICADO');

                    lb_Existe:=True;
             End If;
            UTL_FILE.PUT_LINE(lutl_archivo,iv_Transito||';'
                ||Ln_Index.inconsistencia||';'
                ||Ln_Index.archivo||';'
                ||Ln_Index.nro_placa||';'
                ||Ln_Index.id_usuario||';'
                ||Ln_Index.id_documento||';'
                ||Ln_Index.porcentaje_prop||';'
                ||Ln_Index.id_radicado);
    End Loop;
         UTL_FILE.FCLOSE(lutl_archivo);
End Sp_Inconsistencia_Propietarios;

Procedure Sp_Inconsistencia_Contribuyent As

/*ISVA
Nombre     :Sp_Inconsistencia_Contribuyent
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :iv_Transito
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Genera las inconsistencias por transito 
           :para los contribuyentes
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):=GS_RADICADO||' '||iv_Transito||' CONTRIBUYENTES '||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;
lutl_archivo UTL_FILE.FILE_TYPE;

    -- VALIDO LONGITUD DE ID_USUARIO
        Cursor lcur_contribuyentes Is
        SELECT   iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_USUARIO) > 15 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DOCUMENTO
        SELECT   iv_Transito ,'Longitud ID_DOCUMENTO mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_DOCUMENTO) > 1 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CIUDAD
        SELECT   iv_Transito ,'Longitud ID_CIUDAD mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_CIUDAD) > 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CIUDAD
        SELECT   iv_Transito ,'Longitud NOMBRE_CIUDAD mayor a la permitida(30)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_CIUDAD) > 30 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE APELLIDOS
        SELECT   iv_Transito ,'Longitud APELLIDOS mayor a la permitida(80)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.APELLIDOS) > 80 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRES
        SELECT   iv_Transito ,'Longitud NOMBRES mayor a la permitida(80)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRES) > 80 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE DIRECCION
        SELECT   iv_Transito ,'Longitud DIRECCION mayor a la permitida(100)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.DIRECCION) > 100 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TELEFONO
        SELECT   iv_Transito ,'Longitud TELEFONO mayor a la permitida(14)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.TELEFONO) > 14 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TELEFONO
        SELECT   iv_Transito ,'Longitud TELEFONO MENOR a la permitida(7)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.TELEFONO) < 7 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CELULAR
        SELECT   iv_Transito ,'Longitud CELULAR mayor a la permitida(10)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.CELULAR) > 10 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CELULAR
        SELECT   iv_Transito ,'Longitud CELULAR menor a la permitida(10)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.CELULAR) < 10 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMP_O_PART
        SELECT   iv_Transito ,'Longitud EMP_O_PART mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMP_O_PART) > 1 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE SEXO
        SELECT   iv_Transito ,'Longitud SEXO mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.SEXO) > 1 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_NACIMIENTO
        SELECT   iv_Transito ,'Longitud FECHA_NACIMIENTO mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_NACIMIENTO) > 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_NACIMIENTO
        SELECT   iv_Transito ,'Longitud FECHA_NACIMIENTO menor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_NACIMIENTO) < 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_PAIS
        SELECT   iv_Transito ,'Longitud ID_PAIS mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_PAIS) > 8 and ST_C.id_radicado = GS_RADICADO
         
        union
        
        -- VALIDO LONGITUD DE NOMBRE_PAIS
        SELECT   iv_Transito ,'Longitud NOMBRE_PAIS mayor a la permitida(50)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_PAIS) > 50 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MODIFICACION
        SELECT   iv_Transito ,'Longitud FECHA_MODIFICACION mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_MODIFICACION) > 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MODIFICACION
        SELECT   iv_Transito ,'Longitud FECHA_MODIFICACION menor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_MODIFICACION) < 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FAX
        SELECT   iv_Transito ,'Longitud FAX mayor a la permitida(12)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FAX) > 12 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMAIL
        SELECT   iv_Transito ,'Longitud EMAIL mayor a la permitida(50)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMAIL) > 50 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMAIL
        SELECT   iv_Transito ,'Longitud EMAIL mayor a la permitida(50)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMAIL) > 50 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_ACTUALIZACION
        SELECT   iv_Transito ,'Longitud FECHA_ACTUALIZACION menor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_ACTUALIZACION) > 8 and ST_C.id_radicado = GS_RADICADO
         
        union
        
        -- VALIDO LONGITUD DE FECHA_ACTUALIZACION
        SELECT   iv_Transito ,'Longitud FECHA_ACTUALIZACION menor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_ACTUALIZACION) < 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CIUDAD_DIR
        SELECT   iv_Transito ,'Longitud ID_CIUDAD_DIR mayor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_CIUDAD_DIR) > 8 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CIUDAD_DIR
        SELECT   iv_Transito ,'Longitud NOMBRE_CIUDAD_DIR mayor a la permitida(40)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_CIUDAD_DIR) > 40 and ST_C.id_radicado = GS_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DIRECCION
        SELECT   iv_Transito ,'Longitud ID_DIRECCION mayor a la permitida(20)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, ST_C.*
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_DIRECCION) > 20 and ST_C.id_radicado = GS_RADICADO
        
        
        union 
        
        /*CONTRIBUYENTES*/
        select iv_Transito Secretaria, 
               'Id_Ciudad No Existe en Runt' Inconsistencia, 'Contribuyentes' ARCHIVO,sv.*
        from TMP_CONTRIBUYENTES sv
        left join CORRECCION_DATOS.runt_ciudades rl
                on rl.divipo = sv.ID_CIUDAD_DIR 
        where rl.nombre = '' and sv.id_radicado = GS_RADICADO  
        
        union 
        
        select  iv_Transito Secretaria, 
               'Nombres Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Nombres is null  and sv.id_radicado = GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Apellidos Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Apellidos is null And sv.Id_Documento != 'N' and sv.id_radicado = GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Direccion Null' Inconsistencia,'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Direccion is null  and sv.id_radicado = GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Telefono Null y Celular Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Telefono is null And SV.Celular is Null  and sv.id_radicado = GS_RADICADO
        
        /*union 
        
        select  sv.Id_Radicado, iv_Transito Secretaria, 
               'Celular Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        Inner Join St_Maestro Sm On sv.Id_Radicado = Sm.Id_Radicado
        Inner Join Correccion_datos.Runt_ciudades Sq On Sq.Divipo = Sm.Id_Secretaria
        where  SV.Celular is null  and sv.id_radicado = GS_RADICADO 
        
        union 
        
        select  sv.Id_Radicado, iv_Transito Secretaria, 
               'Email Null' Inconsistencia,'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        Inner Join St_Maestro Sm On sv.Id_Radicado = Sm.Id_Radicado
        Inner Join Correccion_datos.Runt_ciudades Sq On Sq.Divipo = Sm.Id_Secretaria
        where  SV.Email is null  and sv.id_radicado = GS_RADICADO */
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Ciudad_Dir Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        Inner Join St_Maestro Sm On sv.Id_Radicado = Sm.Id_Radicado
        Inner Join Correccion_datos.Runt_ciudades Sq On Sq.Divipo = Sm.Id_Secretaria
        where  SV.Id_Ciudad_Dir is null  and sv.id_radicado = GS_RADICADO
        
        union 
        
        select  iv_Transito Secretaria, 
               'Id_Documento Null' Inconsistencia,'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Id_Documento is null  and sv.id_radicado = GS_RADICADO
        
        union 
        
        select iv_Transito Secretaria, 
               'Id_Usuario Null' Inconsistencia, 'Contribuyentes' ARCHIVO, sv.*
        from TMP_CONTRIBUYENTES sv
        where  SV.Id_Usuario is null  and sv.id_radicado = GS_RADICADO;

Begin
     lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
        For ln_index In lcur_contribuyentes Loop
        
          If lb_Existe = False Then
                        UTL_FILE.PUT_LINE(lutl_archivo,'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'ID_USUARIO;'||'ID_DOCUMENTO;'
                            ||'ID_CIUDAD;'||'NOMBRE_CIUDAD;'||'APELLIDOS;'||'NOMBRES;'||'DIRECCION;'||'TELEFONO;'||'MP_O_PART;'||'SEXO;'
                            ||'FECHA_NACIMIENTO;'||'ID_PAIS;'||'NOMBRE_PAIS;'||'FECHA_MODIFICACION;'||'FAX;'||'EMAIL;'||'FECHA_ACTUALIZACION;'
                            ||'ID_CIUDAD_DIR;'||'NOMBRE_CIUDAD_DIR;'||'ID_DIRECCION;'||'ID_RADICADO;'||'CELULAR');                     
                        lb_Existe:=True;
         End If;
            UTL_FILE.PUT_LINE(lutl_archivo,iv_Transito||';'
                ||ln_index.Inconsistencia ||';'
                ||ln_index.archivo||';'
                ||ln_index.id_usuario||';'
                ||ln_index.id_documento||';'
                ||ln_index.id_ciudad||';'
                ||ln_index.nombre_ciudad||';'
                ||ln_index.apellidos||';'
                ||ln_index.nombres||';'
                ||ln_index.direccion||';'
                ||ln_index.telefono||';'
                ||ln_index.emp_o_part||';'
                ||ln_index.sexo||';'
                ||ln_index.fecha_nacimiento||';'
                ||ln_index.Id_Pais||';'
                ||ln_index.nombre_pais||';'
                ||ln_index.fecha_modificacion||';'
                ||ln_index.fax||';'
                ||ln_index.email||';'
                ||ln_index.fecha_actualizacion||';'
                ||ln_index.id_ciudad_dir||';'
                ||ln_index.nombre_ciudad_dir||';'
                ||ln_index.id_direccion||';'
                ||ln_index.id_radicado||';'
                ||ln_index.celular);
        End Loop;
            UTL_FILE.FCLOSE(lutl_archivo);
End Sp_Inconsistencia_Contribuyent;

Procedure Sp_Validar_Histo_Traspasos As

/*ISVA
Nombre     :Sp_Validar_Histo_Traspasos
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :iv_Transito
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Genera las inconsistencias por transito 
           :para los historiales traspasos
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):=GS_RADICADO||' '||iv_Transito||' HISTORIALES_TRASPASOS '||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;
lutl_archivo UTL_FILE.FILE_TYPE;

  -- VALIDO LONGITUD DE NRO_PLACA
            Cursor lcur_histo_Tras Is
            -- VALIDO LONGITUD DE NRO_PLACA
            SELECT   iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.NRO_PLACA) > 6 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE ID_USUARIO
            SELECT   iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.ID_USUARIO) > 15 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE TIPO_DOCUMENTO_USUARIO
            SELECT   iv_Transito ,'Longitud TIPO_DOCUMENTO_USUARIO mayor a la permitida(1)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.TIPO_DOCUMENTO_USUARIO) > 1 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE ID_COMPRADOR
            SELECT   iv_Transito ,'Longitud ID_COMPRADOR mayor a la permitida(15)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.ID_COMPRADOR) > 15 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE TIPO_DOCUMENTO_COMPRADOR
            SELECT   iv_Transito ,'Longitud TIPO_DOCUMENTO_COMPRADOR mayor a la permitida(1)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.TIPO_DOCUMENTO_COMPRADOR) > 1 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE PORCENTAJE
            SELECT   iv_Transito ,'Longitud PORCENTAJE mayor a la permitida(3)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where length (ST_H.PORCENTAJE) > 3 and ST_H.id_radicado = GS_RADICADO
            
            union
            
            -- VALIDO LONGITUD DE FECHA
            SELECT   iv_Transito ,'Longitud FECHA diferente a la permitida(8)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, ST_H.*
            FROM TMP_HISTORIALES_TRASPASO ST_H
            where  ST_H.id_radicado = GS_RADICADO and (length (ST_H.FECHA) < 8) 
            
            UNION
            
            Select Distinct iv_Transito Secretaria, 
                   'Vendedores No Reportados En Contribuyentes' Inconsistencia, 'Historial Traspaso' ARCHIVO, sh.*
            from TMP_HISTORIALES_TRASPASO sh
            left join tmp_contribuyentes sc on Sh.Id_Usuario = Sc.Id_Usuario And Sh.TIPO_DOCUMENTO_USUARIO = sc.ID_DOCUMENTO and sh.id_radicado = sc.Id_radicado
            where sc.Id_Usuario is null and sh.id_radicado = GS_RADICADO
            
            
            UNION
            
            Select Distinct iv_Transito Secretaria, 
                   'Compradores No Reportados En Contribuyentes' Inconsistencia, 'Historial Traspaso' ARCHIVO, sh.*
            from TMP_HISTORIALES_TRASPASO sh
            left join tmp_contribuyentes sc on Sc.Id_Usuario = Sh.ID_COMPRADOR And Sc.Id_Documento = Sh.TIPO_DOCUMENTO_COMPRADOR and sh.id_radicado = sc.Id_radicado
            where sc.Id_Usuario is null and sh.id_radicado = GS_RADICADO;

Begin 
         lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
        For ln_index In lcur_Histo_Tras Loop
            If lb_Existe = False Then
                        UTL_FILE.PUT_LINE(lutl_archivo,'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'NRO_PLACA;'||'ID_USUARIO;'
                                                        ||'TIPO_DOCUMENTO_USUARIO;'||'ID_COMPRADOR;'||'TIPO_DOCUMENTO_COMPRADOR;'
                                                        ||'PORCENTAJE;'||'FECHA;'||'ID_RADICADO');

                    lb_Existe:=True;
             End If;
            UTL_FILE.PUT_LINE(lutl_archivo,iv_Transito||';'
                ||Ln_Index.inconsistencia||';'
                ||Ln_Index.archivo||';'
                ||Ln_Index.nro_placa||';'
                ||Ln_Index.id_usuario||';'
                ||Ln_Index.tipo_documento_usuario||';'
                ||Ln_Index.id_comprador||';'
                ||Ln_Index.tipo_documento_comprador||';'
                ||Ln_Index.porcentaje||';'
                ||Ln_Index.fecha||';'
                ||Ln_Index.id_radicado);
        End Loop;
    UTL_FILE.FCLOSE(lutl_archivo);
End Sp_Validar_Histo_Traspasos;

Procedure Sp_Detalle_Inconsistencia As

/*
Nombre     :Sp_Detalle_Inconsistencia
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :iv_Transito
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Registra todas la incosistencias 
           :de forma mas detallada
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

lv_Archivo Varchar2(255 byte):= GS_RADICADO||' '||iv_Transito||' DETALLE_INCONSISTENCIA '||To_Char(Sysdate,'dd-mm-yyyy hh24-mi-ss')||'.txt';
lb_Existe Boolean:=False;

lutl_archivo UTL_FILE.FILE_TYPE;

            -- VALIDO LONGITUD DE NRO_PLACA 
        Cursor lcur_detalle_incons Is
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NRO_PLACA) > 6 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
            
        union
        
        -- VALIDO LONGITUD DE ID_MARCA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_MARCA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.ID_MARCA,'.','')) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_MARCA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_MARCA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_MARCA) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE ID_LINEA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_LINEA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.ID_LINEA,'.','')) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_LINEA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_LINEA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_LINEA) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE MODELO
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud MODELO mayor a la permitida(4)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (REPLACE (ST_V.MODELO,'.','')) > 4 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE ID_CLASE
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_CLASE mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_CLASE) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union 
        
        -- VALIDO LONGITUD DE ID_LINEA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_LINEA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_LINEA) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CLASE
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_CLASE mayor a la permitida(40)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_CLASE) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union 
        
        -- VALIDO LONGITUD DE ID_SERVICIO
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_SERVICIO mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_SERVICIO) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union 
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_SERVICIO mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_SERVICIO) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union 
        
        -- VALIDO LONGITUD DE ID_CARROCERIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_CARROCERIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_CARROCERIA) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_CARROCERIA mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_CARROCERIA) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE ID_COMBUSTIBLE
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_COMBUSTIBLE mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_COMBUSTIBLE) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE ID_BATERIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_BATERIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_BATERIA) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO 
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_BATERIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_BATERIA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_BATERIA) > 10 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE POTENCIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud POTENCIA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.POTENCIA) > 10 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud ID_SECRETARIA mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_SECRETARIA) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SECRETARIA
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud NOMBRE_SECRETARIA mayor a la permitida(80)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_SECRETARIA) > 80 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CILINDRAJE
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud CILINDRAJE mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CILINDRAJE) > 10 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_PASAJEROS
        SELECT DISTINCT ST_V.ID_RADICADO ,  iv_Transito ,'Longitud CAP_PASAJEROS mayor a la permitida(3)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CAP_PASAJEROS) > 3 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_TONELADAS
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud CAP_TONELADAS mayor a la permitida(6)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CAP_TONELADAS) > 6 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE VALOR_FACTURA
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud VALOR_FACTURA mayor a la permitida(10)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.VALOR_FACTURA) > 10 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE BLINDADO
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud BLINDADO mayor a la permitida(1)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.BLINDADO) > 1 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE IMPORTADO_NACIONAL
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud IMPORTADO_NACIONAL mayor a la permitida(2)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.IMPORTADO_NACIONAL) > 2 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_ESTADO
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud ID_ESTADO mayor a la permitida(4)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.ID_ESTADO) > 4 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_ESTADO
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud NOMBRE_ESTADO mayor a la permitida(40)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NOMBRE_ESTADO) > 40 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CLASICO_ANTIGUO
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud CLASICO_ANTIGUO mayor a la permitida(1)' as INCONSISTENCIA,'VEHICULOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.CLASICO_ANTIGUO) > 1 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NRO_PUERTAS
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud NRO_PUERTAS mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.NRO_PUERTAS) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MATRICULO
        SELECT DISTINCT ST_V.ID_RADICADO , iv_Transito ,'Longitud FECHA_MATRICULO mayor a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.FECHA_MATRICULO) > 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MATRICULO
        SELECT DISTINCT  ST_V.ID_RADICADO , iv_Transito ,'Longitud FECHA_MATRICULO menos a la permitida(8)' as INCONSISTENCIA, 'VEHICULOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_VEHICULOS ST_V
        where length (ST_V.FECHA_MATRICULO) < 8 and ST_V.id_radicado = GS_RADICADO
        GROUP BY ST_V.ID_RADICADO 
        --ORDER BY ST_V.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_USUARIO) > 15 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DOCUMENTO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_DOCUMENTO mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_DOCUMENTO) > 1 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CIUDAD
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_CIUDAD mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_CIUDAD) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CIUDAD
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_CIUDAD mayor a la permitida(30)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_CIUDAD) > 30 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE APELLIDOS
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud APELLIDOS mayor a la permitida(80)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.APELLIDOS) > 80 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRES
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud NOMBRES mayor a la permitida(80)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRES) > 80 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE DIRECCION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud DIRECCION mayor a la permitida(100)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.DIRECCION) > 100 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TELEFONO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud TELEFONO mayor a la permitida(14)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.TELEFONO) > 14 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TELEFONO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud TELEFONO MENOR a la permitida(7)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.TELEFONO) < 7 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CELULAR
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud CELULAR mayor a la permitida(10)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.CELULAR) > 10 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CELULAR
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud CELULAR menor a la permitida(10)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.CELULAR) < 10 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMP_O_PART
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud EMP_O_PART mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMP_O_PART) > 1 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE SEXO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud SEXO mayor a la permitida(1)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.SEXO) > 1 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_NACIMIENTO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_NACIMIENTO mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_NACIMIENTO) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_NACIMIENTO
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_NACIMIENTO menor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_NACIMIENTO) < 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_PAIS
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_PAIS mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_PAIS) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO  
        --ORDER BY ST_C.ID_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_PAIS
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_PAIS mayor a la permitida(50)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_PAIS) > 50 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MODIFICACION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_MODIFICACION mayor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_MODIFICACION) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_MODIFICACION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_MODIFICACION menor a la permitida(8)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_MODIFICACION) < 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FAX
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FAX mayor a la permitida(12)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FAX) > 12 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMAIL
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud EMAIL mayor a la permitida(50)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMAIL) > 50 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE EMAIL
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud EMAIL mayor a la permitida(50)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.EMAIL) > 50 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_ACTUALIZACION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_ACTUALIZACION menor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_ACTUALIZACION) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO  
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_ACTUALIZACION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud FECHA_ACTUALIZACION menor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.FECHA_ACTUALIZACION) < 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CIUDAD_DIR
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_CIUDAD_DIR mayor a la permitida(8)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_CIUDAD_DIR) > 8 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CIUDAD_DIR
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_CIUDAD_DIR mayor a la permitida(40)' as INCONSISTENCIA, 'CONTRIBUYENTES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.NOMBRE_CIUDAD_DIR) > 40 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DIRECCION
        SELECT DISTINCT ST_C.ID_RADICADO, iv_Transito ,'Longitud ID_DIRECCION mayor a la permitida(20)' as INCONSISTENCIA,'CONTRIBUYENTES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_CONTRIBUYENTES ST_C
        where length (ST_C.ID_DIRECCION) > 20 and ST_C.id_radicado = GS_RADICADO
        GROUP BY ST_C.ID_RADICADO 
        --ORDER BY ST_C.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NRO_PLACA
        SELECT DISTINCT ST_P.ID_RADICADO, iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_propietarios ST_P
        where length (ST_P.NRO_PLACA) > 6 and ST_P.id_radicado = GS_RADICADO
        GROUP BY ST_P.ID_RADICADO 
        --ORDER BY ST_P.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO
        SELECT DISTINCT ST_P.ID_RADICADO, iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_propietarios ST_P
        where length (ST_P.ID_USUARIO) > 15 and ST_P.id_radicado = GS_RADICADO
        GROUP BY ST_P.ID_RADICADO 
        --ORDER BY ST_P.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_DOCUMENTO
        SELECT DISTINCT ST_P.ID_RADICADO, iv_Transito ,'Longitud ID_DOCUMENTO mayor a la permitida(1)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_propietarios ST_P
        where length (ST_P.ID_DOCUMENTO) > 1 and ST_P.id_radicado = GS_RADICADO
        GROUP BY ST_P.ID_RADICADO 
        --ORDER BY ST_P.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT DISTINCT ST_P.ID_RADICADO, iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA,'PROPIETARIOS' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_propietarios ST_P
        where length (ST_P.PORCENTAJE_PROP) > 3 and ST_P.id_radicado = GS_RADICADO
        GROUP BY ST_P.ID_RADICADO 
        --ORDER BY ST_P.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT DISTINCT ST_P.ID_RADICADO, iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA, 'PROPIETARIOS' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_propietarios ST_P
        where length (ST_P.PORCENTAJE_PROP) > 3 and ST_P.id_radicado = GS_RADICADO
        GROUP BY ST_P.ID_RADICADO 
        --ORDER BY ST_P.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NRO_PLACA
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NRO_PLACA) > 6 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_TRAMITE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_TRAMITE mayor a la permitida(4)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_TRAMITE) > 4 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_TRAMITE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_TRAMITE mayor a la permitida(40)' as INCONSISTENCIA, 'TRAMITES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_TRAMITE) > 40 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA_TRAMITE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud FECHA_TRAMITE mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.FECHA_TRAMITE) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        -- VALIDO LONGITUD DE FECHA_TRAMITE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud FECHA_TRAMITE menor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.FECHA_TRAMITE) < 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        /*union
        
        -- VALIDO LONGITUD DE TIPO_CANCELACION
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud TIPO_CANCELACION mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        INNER JOIN ST_MAESTRO ST_M ON ST_T.ID_RADICADO = ST_M.ID_RADICADO
        INNER JOIN CORRECCION_DATOS.RUNT_CIUDADES RC ON RC.DIVIPO = ST_M.ID_SECRETARIA
        where length (ST_T.TIPO_CANCELACION) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO*/
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA_DESTINO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_SECRETARIA_DESTINO mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SECRETARIA_DESTINO) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SECRETARIA_ORIGEN
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_SECRETARIA_ORIGEN mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SECRETARIA_ORIGEN) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CARROCERIA_ANTERIOR
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_CARROCERIA_ANTERIOR mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_CARROCERIA_ANTERIOR) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA_ANTERIOR
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_CARROCERIA_ANTERIOR mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_CARROCERIA_ANTERIOR) > 40 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_CARROCERIA_NUEVA
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_CARROCERIA_NUEVA mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_CARROCERIA_NUEVA) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_CARROCERIA_NUEVA
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_CARROCERIA_NUEVA mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_CARROCERIA_NUEVA) > 40 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SERVICIO_ANTERIOR
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_SERVICIO_ANTERIOR mayor a la permitida(8)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SERVICIO_ANTERIOR) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO_ANTERIOR
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_SERVICIO_ANTERIOR mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_SERVICIO_ANTERIOR) > 40 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_SERVICIO_NUEVO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_SERVICIO_NUEVO mayor a la permitida(8)' as INCONSISTENCIA, 'TRAMITES' as ARCHIVO,COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_SERVICIO_NUEVO) > 8 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NOMBRE_SERVICIO_NUEVO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NOMBRE_SERVICIO_NUEVO mayor a la permitida(40)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NOMBRE_SERVICIO_NUEVO) > 40 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO_ANTERIOR
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_USUARIO_ANTERIOR mayor a la permitida(15)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_USUARIO_ANTERIOR) > 15 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO_NUEVO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud ID_USUARIO_NUEVO mayor a la permitida(15)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.ID_USUARIO_NUEVO) > 15 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE_PROP
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud PORCENTAJE_PROP mayor a la permitida(3)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.PORCENTAJE_PROP) > 3 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CLASICO_ANTIGUO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud CLASICO_ANTIGUO mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CLASICO_ANTIGUO) > 1 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE BLINDADO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud BLINDADO mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.BLINDADO) > 1 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE NIVEL_BLINDADO
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud NIVEL_BLINDADO mayor a la permitida(2)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.NIVEL_BLINDADO) > 2 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        
        union
        
        -- VALIDO LONGITUD DE DESBLINDAJE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud DESBLINDAJE mayor a la permitida(1)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.DESBLINDAJE) > 1 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CILINDRAJE
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud CILINDRAJE mayor a la permitida(10)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CILINDRAJE) > 10 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_PASAJEROS
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud CAP_PASAJEROS mayor a la permitida(3)' as INCONSISTENCIA,'TRAMITES' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CAP_PASAJEROS) > 3 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE CAP_TONELADAS
        SELECT DISTINCT ST_T.ID_RADICADO, iv_Transito ,'Longitud CAP_TONELADAS mayor a la permitida(6)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_TRAMITES ST_T
        where length (ST_T.CAP_TONELADAS) > 6 and ST_T.id_radicado = GS_RADICADO
        GROUP BY ST_T.ID_RADICADO 
        --ORDER BY ST_T.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE NRO_PLACA
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud NRO_PLACA mayor a la permitida(6)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.NRO_PLACA) > 6 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ----ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_USUARIO
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud ID_USUARIO mayor a la permitida(15)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.ID_USUARIO) > 15 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ----ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TIPO_DOCUMENTO_USUARIO
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud TIPO_DOCUMENTO_USUARIO mayor a la permitida(1)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.TIPO_DOCUMENTO_USUARIO) > 1 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ----ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE ID_COMPRADOR
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud ID_COMPRADOR mayor a la permitida(15)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.ID_COMPRADOR) > 15 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ----ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE TIPO_DOCUMENTO_COMPRADOR
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud TIPO_DOCUMENTO_COMPRADOR mayor a la permitida(1)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.TIPO_DOCUMENTO_COMPRADOR) > 1 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ------ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE PORCENTAJE
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud PORCENTAJE mayor a la permitida(3)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where length (ST_H.PORCENTAJE) > 3 and ST_H.id_radicado = GS_RADICADO
        GROUP BY ST_H.ID_RADICADO 
        ------ORDER BY ST_H.ID_RADICADO
        
        union
        
        -- VALIDO LONGITUD DE FECHA
        SELECT DISTINCT ST_H.ID_RADICADO, iv_Transito ,'Longitud FECHA diferente a la permitida(16)' as INCONSISTENCIA,'HISTORIALES_TRASPASO' as ARCHIVO, COUNT(1) CANTIDAD
        FROM TMP_HISTORIALES_TRASPASO ST_H
        where  ST_H.id_radicado = GS_RADICADO and (length (ST_H.FECHA) < 16) 
        GROUP BY ST_H.ID_RADICADO 
        --ORDER BY ID_RADICADO,ARCHIVO;
        
        Union
        
        --Validaciones tramites.
        
        --Radicaciones Sin Id_Origen.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Radicaciones Sin Id_Origen' Inconsistencia, 'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 10 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Origen is null
        Group By St.Id_Radicado
        
        union
        
        --Radicaciones Sin Id_Destino.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Radicaciones Sin Id_Destino' Inconsistencia, 'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 10 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Destino Is Null
        Group By St.Id_Radicado
        
        union
        
        --Traslados Sin Id_Origen.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Traslados Sin Id_Origen' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 15 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Origen Is Null
        Group By St.Id_Radicado
        
        union
        
        --Traslados Sin Id_Destino.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Traslados Sin Id_Destino' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 15 and St.id_radicado = GS_RADICADO
          And St.Id_Secretaria_Destino Is Null
        Group By St.Id_Radicado
        
        union
        
        --Blindajes Sin Nivel Blindado.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Blindajes Sin Nivel Blindado' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 1 and St.id_radicado = GS_RADICADO
          And St.Blindado Is Not Null And St.Nivel_Blindado is null
        Group By St.Id_Radicado
        
        union
        
        --Transformacion Carroceria Carga Con Capacidad Pasajeros > 3.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria,  
               'Transformacion Carroceria Carga Con Capacidad Casajeros > 3' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 14 and St.id_radicado = GS_RADICADO
          And St.Id_Carroceria_Nueva in('7','8','9','10','12','13','15','17','18','20','21','31','32','42','43',
                                        '44','45','47','58','60','70','78','79','80','83','84','96','98','104',
                                        '115','116','119','125','133','136','142','150','172','174','187','189',
                                        '192','193','196','197','198','199')
          And to_number(St.Cap_Pasajeros) > 3        
        Group By St.Id_Radicado
        
        union
        
        --Id_carroceria nueva != carroceria OC
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Id_Carroceria Nueva Diferente a Carroceria OC' Inconsistencia,'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        From TMP_VEHICULOS sv
        inner join TMP_TRAMITES St on st.nro_placa = sv.nro_placa
        Where St.Id_Tramite = 14  and St.id_radicado = GS_RADICADO
          And SV.ID_CARROCERIA is not null
          And SV.ID_CARROCERIA != ST.ID_CARROCERIA_NUEVA
          And sv.id_radicado = st.id_radicado
        Group By St.Id_Radicado
        
        union
        
        --Porcentaje Traspaso Mayor a 100.
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Porcentaje Traspaso Mayor a 100' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite in (16,65) and St.id_radicado = GS_RADICADO
          And to_number(replace(St.Porcentaje_Prop,'.','')) > 100
        Group By St.Id_Radicado
        
        union
        
        
        --Id_Comprador igual a Id_Vendedor
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Id_Comprador Igual a Id_Vendedor' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite in (16,65) and St.id_radicado = GS_RADICADO
          And ST.ID_USUARIO_nuevo = ST.ID_USUARIO_anterior
        Group By St.Id_Radicado
        
        union
        
        --ID_SERVICIO_ANTERIOR = ID_SERVICIO_NUEVO
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Id_Servicio_Anterior Igual a Id_Servicio_Nuevo' Inconsistencia,'TRAMITES' ARCHIVO, Count(1) Cantidad 
        From TMP_TRAMITES St
        Where St.Id_Tramite = 6 and St.id_radicado = GS_RADICADO
          And ST.ID_SERVICIO_ANTERIOR = ST.ID_SERVICIO_NUEVO
        Group By St.Id_Radicado
        
        union
        
        --ID_SERVICIO_ANTERIOR = ID_SERVICIO_NUEVO
        Select Distinct St.Id_Radicado, iv_Transito Secretaria, 
               'Id_Servicio_Nuevo Diferente a Id_Servicio_Oc' Inconsistencia,'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        From TMP_VEHICULOS sv
        inner join TMP_TRAMITES St on st.nro_placa = sv.nro_placa
        Where St.Id_Tramite = 6 and St.id_radicado = GS_RADICADO
          And sv.ID_SERVICIO != ST.ID_SERVICIO_NUEVO
          And sv.id_radicado = st.id_radicado
        Group By St.Id_Radicado
        
        /*VALIDAMOS PARAMETRICAS RUNT*/
        UNION 
        --Carrocerias x clase Vehiculos
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Carroceria Sin Relacion a La Clase (Vehiculos)' Inconsistencia,'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        from TMP_VEHICULOS sv
        left join CORRECCION_DATOS.RUNT_CARROCERIAS_X_CLASE rc
                on rc.codigo_clase = REPLACE (sv.id_clase,'.','') and rc.codigo_carroceria_ws = REPLACE (SV.ID_CARROCERIA,'.','')
        where RC.CODIGO_CARROCERIA_WS is null  And Sv.Id_Carroceria is Not null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
         
        union
        
        --Carrocerias x clase tramites transformacion
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Carroceria Sin Relacion a La Clase (Tramites)' Inconsistencia, 'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        from TMP_VEHICULOS sv
        inner join TMP_TRAMITES st on st.nro_placa = sv.nro_placa AND SV.ID_RADICADO = ST.ID_RADICADO
        left join CORRECCION_DATOS.RUNT_CARROCERIAS_X_CLASE rc
                on rc.codigo_clase = REPLACE (sv.id_clase,'.','')  and rc.codigo_carroceria_ws =REPLACE (st.ID_CARROCERIA_nueva,'.','') 
        where  st.id_tramite = 14 And RC.CODIGO_CARROCERIA_WS is null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        

        
        union
        
        
        --Lineas sin relacion a la marca transformacion
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Linea Sin Relacion a La Marca' Inconsistencia,'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        from TMP_VEHICULOS sv
        left join CORRECCION_DATOS.runt_linea rl
                on rl.codigo_marca = REPLACE (sv.id_marca,'.','') and rl.codigo_linea_ws = REPLACE (sv.ID_LINEA,'.','')
        where  rl.codigo_linea_ws is null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        
        union
        
        --Id_Marca con punto
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Marca con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where sv.id_marca like '%.%' and sv.id_radicado = GS_RADICADO
        Group By sv.Id_Radicado
        
        union
        
        --Id_Linea con punto
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Linea con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where sv.id_linea like '%.%' and sv.id_radicado = GS_RADICADO
        Group By sv.Id_Radicado
        
        union
        
        --Id_Linea con punto
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Modelo con punto' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where sv.modelo like '%.%' and sv.id_radicado = GS_RADICADO
        Group By sv.Id_Radicado
        
        union
        
        /*VALIDACION DE CAMPOS NULL*/
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Marca Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Id_Marca is null  and sv.id_radicado = GS_RADICADO 
        Group By Sv.Id_Radicado
        
        union
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Nro_placa Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  Sv.nro_placa is null and sv.id_radicado = GS_RADICADO 
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Linea Null' Inconsistencia,'VEHICULOS' ARCHIVO, Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.id_linea is null  and sv.id_radicado = GS_RADICADO 
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Modelo Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Modelo is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Clase Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.ID_CLASE is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Servicio Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Id_Servicio is null and sv.id_radicado = GS_RADICADO 
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Carroceria Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Id_Carroceria is null and sv.id_radicado = GS_RADICADO 
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Combustible Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Id_Combustible is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Secretaria Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Id_Secretaria is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Cilindraje Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Cilindraje is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Valor_Factura Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Valor_Factura is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Fecha_Matriculo Null' Inconsistencia, 'VEHICULOS' ARCHIVO,Count(1) Cantidad 
        from TMP_VEHICULOS sv
        where  SV.Fecha_Matriculo is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Usuario Null' Inconsistencia,'PROPIETARIOS' ARCHIVO, Count(1) Cantidad 
        from TMP_propietarios sv
        where  SV.Id_Usuario is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Documento Null' Inconsistencia, 'PROPIETARIOS' ARCHIVO,Count(1) Cantidad 
        from TMP_propietarios sv
        where  SV.Id_Documento is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Porcentaje_Propiedad Null' Inconsistencia, 'PROPIETARIOS' ARCHIVO,Count(1) Cantidad 
        from TMP_propietarios sv
        where  SV.Porcentaje_Prop is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        /*CONTRIBUYENTES*/
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Ciudad No Existe en Runt' Inconsistencia, 'Contribuyentes' ARCHIVO,Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        left join CORRECCION_DATOS.runt_ciudades rl
                on rl.divipo = sv.ID_CIUDAD_DIR 
        where rl.nombre = '' and sv.id_radicado = GS_RADICADO  
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Nombres Null' Inconsistencia, 'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Nombres is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Apellidos Null' Inconsistencia, 'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Apellidos is null And sv.Id_Documento != 'N' and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Direccion Null' Inconsistencia,'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Direccion is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Telefono Null y Celular Null' Inconsistencia, 'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Telefono is null  and SV.Celular is null And sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        /*
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Email Null' Inconsistencia,'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        Inner Join St_Maestro Sm On sv.Id_Radicado = Sm.Id_Radicado
        Inner Join Correccion_datos.Runt_ciudades Sq On Sq.Divipo = Sm.Id_Secretaria
        where  SV.Email is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado 
        
        union  */
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Ciudad_Dir Null' Inconsistencia, 'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Id_Ciudad_Dir is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Documento Null' Inconsistencia,'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Id_Documento is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Usuario Null' Inconsistencia, 'Contribuyentes' ARCHIVO, Count(1) Cantidad 
        from TMP_CONTRIBUYENTES sv
        where  SV.Id_Usuario is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        union 
        
        select Distinct sv.Id_Radicado, iv_Transito Secretaria, 
               'Id_Tramite Null' Inconsistencia, 'TRAMITES' ARCHIVO, Count(1) Cantidad 
        from TMP_TRAMITES sv
        where  SV.Id_Tramite is null  and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        Union
        
        Select Distinct Sv.Id_Radicado, iv_Transito Secretaria, 
               'Vehiculos No Reportados En Tramites' Inconsistencia, 'Vehiculos' ARCHIVO, Count(1) Cantidad 
        from tmp_vehiculos sv
        left join tmp_tramites st on st.nro_placa = sv.nro_placa and sv.id_radicado = st.Id_radicado
        where st.nro_placa is null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        UNION
        
        Select Distinct Sv.Id_Radicado, iv_Transito Secretaria, 
               'Vehiculos No Reportados En Propietarios' Inconsistencia, 'Vehiculos' ARCHIVO, Count(1) Cantidad 
        from tmp_vehiculos sv
        left join tmp_propietarios sp on sp.nro_placa = sv.nro_placa and sv.id_radicado = sp.Id_radicado
        where sp.nro_placa is null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado
        
        UNION
        
        Select Distinct Sv.Id_Radicado, iv_Transito Secretaria, 
               'Tramites No Reportados En Propietarios' Inconsistencia, 'Tramites' ARCHIVO, Count(1) Cantidad 
        from tmp_tramites sv
        left join tmp_propietarios sp on sp.nro_placa = sv.nro_placa and sv.id_radicado = sp.Id_radicado
        where sp.nro_placa is null and sv.id_radicado = GS_RADICADO
        Group By Sv.Id_Radicado 
        
        UNION
        
        Select Distinct st.Id_Radicado, iv_Transito Secretaria, 
               'Tramites No Reportados En Vehiculos' Inconsistencia, 'Tramites' ARCHIVO, Count(1) Cantidad 
        from tmp_tramites st
        left join tmp_vehiculos sv on sv.nro_placa = st.nro_placa and sv.id_radicado = st.Id_radicado
        where sv.nro_placa is null and st.id_radicado = GS_RADICADO
        Group By st.Id_Radicado 
        
        UNION
        
        Select Distinct sp.Id_Radicado, iv_Transito Secretaria, 
               'Propietarios No Reportados En Vehiculos' Inconsistencia, 'Propietarios' ARCHIVO, Count(1) Cantidad 
        from tmp_Propietarios sp
        left join tmp_vehiculos sv on sp.nro_placa = sv.nro_placa and sp.id_radicado = sv.Id_radicado
        where sv.nro_placa is null and sp.id_radicado = GS_RADICADO
        Group By sp.Id_Radicado 
        
        UNION
        
        Select Distinct sp.Id_Radicado, iv_Transito Secretaria, 
               'Propietarios No Reportados En Tramites' Inconsistencia, 'Propietarios' ARCHIVO, Count(1) Cantidad 
        from tmp_Propietarios sp
        left join tmp_tramites st on sp.nro_placa = st.nro_placa and sp.id_radicado = st.Id_radicado
        where st.nro_placa is null and sp.id_radicado = GS_RADICADO
        Group By sp.Id_Radicado 
        
        UNION
        
        Select Distinct Sp.Id_Radicado, iv_Transito Secretaria, 
               'Propietarios No Reportados En Contribuyentes' Inconsistencia, 'Propietarios' ARCHIVO, Count(1) Cantidad 
        from tmp_Propietarios sp
        left join tmp_contribuyentes sc on Sp.Id_Usuario = Sc.Id_Usuario And Sp.Id_Documento = Sc.Id_Documento and sp.id_radicado = sc.Id_radicado
        where sc.Id_Usuario is null and sp.id_radicado = GS_RADICADO
        Group By Sp.Id_Radicado 
        
        UNION
        
        Select Distinct Sh.Id_Radicado, iv_Transito Secretaria, 
               'Vendedores No Reportados En Contribuyentes' Inconsistencia, 'Historial Traspaso' ARCHIVO, Count(1) Cantidad 
        from tmp_historiales_traspaso sh
        left join tmp_contribuyentes sc on Sh.Id_Usuario = Sc.Id_Usuario And Sh.TIPO_DOCUMENTO_USUARIO = sc.ID_DOCUMENTO and sh.id_radicado = sc.Id_radicado
        where sc.Id_Usuario is null and sh.id_radicado = GS_RADICADO
        Group By Sh.Id_Radicado 
        
        UNION
        
        Select Distinct Sh.Id_Radicado, iv_Transito Secretaria, 
               'Compradores No Reportados En Contribuyentes' Inconsistencia, 'Historial Traspaso' ARCHIVO, Count(1) Cantidad 
        from tmp_historiales_traspaso sh
        left join tmp_contribuyentes sc on Sc.Id_Usuario = Sh.ID_COMPRADOR And Sc.Id_Documento = Sh.TIPO_DOCUMENTO_COMPRADOR and sh.id_radicado = sc.Id_radicado
        where sc.Id_Usuario is null and sh.id_radicado = GS_RADICADO
        Group By Sh.Id_Radicado ;

Begin
    lutl_archivo := UTL_FILE.FOPEN('INCONSISTENCIA_TTO',lv_Archivo,'W');  
        For ln_index In lcur_Detalle_Incons Loop
                    If lb_Existe = False Then
                            UTL_FILE.PUT_LINE(lutl_archivo,'ID_RADICADO;'||'SECRETARIA;'||'INCONSISTENCIA;'||'ARCHIVO;'||'CANTIDAD');
                        lb_Existe:=True;
                    End If;
                UTL_FILE.PUT_LINE(lutl_archivo,ln_index.id_radicado||';'
                    ||iv_Transito||';'
                    ||ln_index.inconsistencia||';'
                    ||ln_index.archivo||';'
                    ||ln_index.cantidad);
        End Loop;
     UTL_FILE.FCLOSE(lutl_archivo);
End Sp_Detalle_Inconsistencia;

Procedure Sp_Iniciar_Inconsistencia (as_id_radicado Simple_Integer) AS

/*ISVA
Nombre     :Sp_Iniciar_Inconsistencia
Autor      :Blados.Ospina
Fecha      :07/05/18
Parametros :iv_Transito
Retorno    :          
Proyecto   :PKG_INCONSISTENCIAS_TRANSITOS
VersiÛn    :1.0
Objetivo   :Ejecuta todos los procesos del pl-sql
**************************************************************************
control de cambios realizados por desarrolladores
**************************************************************************
Fecha       Autor           Version  Modificacion   
07/05/2018  Blados.Ospina   1.0                     */

BEGIN

GS_RADICADO := as_id_radicado;

    Sp_Registrar_Transito;
    SP_Inconsistencia_Vehiculos;
    Sp_Inconsistencia_Tramites;
    Sp_Inconsistencia_Propietarios;
    Sp_Inconsistencia_Contribuyent;
    Sp_Validar_Histo_Traspasos;
    Sp_Detalle_Inconsistencia;
    
END Sp_Iniciar_Inconsistencia;

END PKG_INCONSISTENCIAS_TRANSITOS;
